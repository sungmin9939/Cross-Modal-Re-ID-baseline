
==> Loading data..
Dataset sysu statistics:
  ------------------------------
  subset   | # ids | # images
  ------------------------------
  visible  |   395 |    22258
  thermal  |   395 |    11909
  ------------------------------
  query    |    96 |     3803
  gallery  |    96 |      301
  ------------------------------
Data Loading Time:	 16.512
==> Building model..
==> Start Training...
==> Preparing Data Loader...
0
[20927 20945 20945 ...  4515  4467  4490]
[10597 10605 10597 ...  1932  1948  1928]
Epoch: [0][0/347] lr:0.00035 Loss: 30.5782 (30.5782) rgb_proxy_loss: 9.4069 (9.4069) ir_proxy_loss: 10.8608 (10.8608) mono_proxy_loss: 10.3105 (10.3105)
Epoch: [0][50/347] lr:0.00035 Loss: 19.1627 (23.3609) rgb_proxy_loss: 6.2041 (7.8955) ir_proxy_loss: 6.6020 (7.6233) mono_proxy_loss: 6.3566 (7.8421)
Epoch: [0][100/347] lr:0.00035 Loss: 18.6020 (21.1121) rgb_proxy_loss: 6.1322 (7.0518) ir_proxy_loss: 6.1708 (6.9816) mono_proxy_loss: 6.2991 (7.0786)
Epoch: [0][150/347] lr:0.00035 Loss: 18.6900 (20.2979) rgb_proxy_loss: 6.0483 (6.7288) ir_proxy_loss: 6.3149 (6.7250) mono_proxy_loss: 6.3268 (6.8441)
Epoch: [0][200/347] lr:0.00035 Loss: 17.9969 (19.7877) rgb_proxy_loss: 5.6884 (6.4915) ir_proxy_loss: 5.9311 (6.5617) mono_proxy_loss: 6.3774 (6.7344)
Epoch: [0][250/347] lr:0.00035 Loss: 17.2353 (19.3829) rgb_proxy_loss: 5.3717 (6.2847) ir_proxy_loss: 5.0676 (6.4053) mono_proxy_loss: 6.7960 (6.6929)
Epoch: [0][300/347] lr:0.00035 Loss: 16.1620 (18.9705) rgb_proxy_loss: 4.5952 (6.0756) ir_proxy_loss: 5.0806 (6.2183) mono_proxy_loss: 6.4862 (6.6766)
==> Preparing Data Loader...
1
[22141 22148 22154 ... 21298 21292 21296]
[11801 11797 11805 ... 10959 10962 10960]
Epoch: [1][0/347] lr:0.00035 Loss: 16.2609 (16.2609) rgb_proxy_loss: 4.5600 (4.5600) ir_proxy_loss: 4.9873 (4.9873) mono_proxy_loss: 6.7136 (6.7136)
Epoch: [1][50/347] lr:0.00035 Loss: 15.0484 (14.6154) rgb_proxy_loss: 4.3709 (4.0205) ir_proxy_loss: 4.1738 (4.1502) mono_proxy_loss: 6.5037 (6.4447)
Epoch: [1][100/347] lr:0.00035 Loss: 13.1423 (13.9955) rgb_proxy_loss: 3.2561 (3.7850) ir_proxy_loss: 3.5798 (3.7946) mono_proxy_loss: 6.3064 (6.4159)
Epoch: [1][150/347] lr:0.00035 Loss: 13.2130 (13.5037) rgb_proxy_loss: 3.1340 (3.5424) ir_proxy_loss: 3.3465 (3.5368) mono_proxy_loss: 6.7325 (6.4246)
Epoch: [1][200/347] lr:0.00035 Loss: 11.4744 (13.0450) rgb_proxy_loss: 2.0823 (3.3155) ir_proxy_loss: 2.7786 (3.2991) mono_proxy_loss: 6.6136 (6.4304)
Epoch: [1][250/347] lr:0.00035 Loss: 11.0294 (12.5971) rgb_proxy_loss: 1.9875 (3.0848) ir_proxy_loss: 2.4305 (3.0688) mono_proxy_loss: 6.6114 (6.4434)
Epoch: [1][300/347] lr:0.00035 Loss: 9.1488 (12.1872) rgb_proxy_loss: 1.4064 (2.8716) ir_proxy_loss: 1.4169 (2.8655) mono_proxy_loss: 6.3255 (6.4501)
Test Epoch: 1
Extracting Gallery Feature...
Traceback (most recent call last):
  File "train_v2.py", line 495, in <module>
    cmc, mAP, mINP, cmc_att, mAP_att, mINP_att = test(epoch)
  File "train_v2.py", line 419, in test
    feat, feat_att = net(x2=input, modal=test_mode[1])
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 155, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 165, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/parallel_apply.py", line 85, in parallel_apply
    output.reraise()
  File "/opt/conda/lib/python3.7/site-packages/torch/_utils.py", line 395, in reraise
    raise self.exc_type(msg)
AttributeError: Caught AttributeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/parallel/parallel_apply.py", line 60, in _worker
    output = module(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/data/Cross-Modal-Re-ID-baseline/model.py", line 521, in forward
    batch_size = x1.size(0)
Extracting Time:	 5.403
Extracting Query Feature...
AttributeError: 'NoneType' object has no attribute 'size'