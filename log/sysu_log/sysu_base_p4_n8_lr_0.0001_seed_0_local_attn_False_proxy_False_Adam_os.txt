==========
Args:Namespace(arch='resnet50', batch_size=8, dataset='sysu', gpu='0', img_h=288, img_w=144, local_attn=False, log_path='log/', lr=0.0001, margin=0.3, method='base', mode='all', model_path='save_model/', num_pos=4, optim='Adam', proxy=False, resume='sysu_base_p4_n8_lr_0.0001_seed_0_local_attn_False_proxy_False_Adam_os.txt', save_epoch=20, seed=0, test_batch=64, test_only=False, trial=1, vis_log_path='log/vis_log/', warm=0, workers=4)
==========
==> Loading data..
Dataset sysu statistics:
  ------------------------------
  subset   | # ids | # images
  ------------------------------
  visible  |   395 |    22258
  thermal  |   395 |    11909
  ------------------------------
  query    |    96 |     3803
  gallery  |    96 |      301
  ------------------------------
Data Loading Time:	 17.931
==> Building model..
==> no checkpoint found at sysu_base_p4_n8_lr_0.0001_seed_0_local_attn_False_proxy_False_Adam_os.txt
==> Start Training...
==> Preparing Data Loader...
0
[20927 20945 20945 ...  6753  6784  6761]
[10597 10605 10597 ...  2900  2898  2916]
Epoch: [0][0/695] Time: 15.390 (15.390) lr:0.00010 Loss: 9.6787 (9.6787) iLoss: 5.9838 (5.9838) TLoss: 3.6949 (3.6949) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.00
Epoch: [0][50/695] Time: 0.409 (0.717) lr:0.00010 Loss: 7.6678 (8.3677) iLoss: 5.9903 (5.9836) TLoss: 1.6776 (2.3841) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.23
Epoch: [0][100/695] Time: 0.409 (0.569) lr:0.00010 Loss: 6.5871 (7.6791) iLoss: 5.9731 (5.9863) TLoss: 0.6140 (1.6927) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.25
Epoch: [0][150/695] Time: 0.413 (0.520) lr:0.00010 Loss: 6.4790 (7.2941) iLoss: 6.0469 (5.9946) TLoss: 0.4321 (1.2995) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.27
Epoch: [0][200/695] Time: 0.403 (0.496) lr:0.00010 Loss: 6.3383 (7.0711) iLoss: 5.9679 (5.9971) TLoss: 0.3704 (1.0740) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [0][250/695] Time: 0.415 (0.480) lr:0.00010 Loss: 6.2542 (6.9257) iLoss: 5.9088 (5.9950) TLoss: 0.3454 (0.9307) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.23
Epoch: [0][300/695] Time: 0.419 (0.471) lr:0.00010 Loss: 6.2869 (6.8245) iLoss: 5.9559 (5.9923) TLoss: 0.3310 (0.8321) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.25
Epoch: [0][350/695] Time: 0.401 (0.464) lr:0.00010 Loss: 6.2860 (6.7511) iLoss: 5.9607 (5.9908) TLoss: 0.3253 (0.7603) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [0][400/695] Time: 0.415 (0.458) lr:0.00010 Loss: 6.3205 (6.6949) iLoss: 6.0001 (5.9894) TLoss: 0.3205 (0.7055) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [0][450/695] Time: 0.417 (0.454) lr:0.00010 Loss: 6.2930 (6.6509) iLoss: 5.9739 (5.9883) TLoss: 0.3191 (0.6626) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [0][500/695] Time: 0.410 (0.450) lr:0.00010 Loss: 6.3064 (6.6150) iLoss: 5.9951 (5.9872) TLoss: 0.3113 (0.6278) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [0][550/695] Time: 0.407 (0.447) lr:0.00010 Loss: 6.2864 (6.5857) iLoss: 5.9755 (5.9866) TLoss: 0.3108 (0.5991) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [0][600/695] Time: 0.411 (0.445) lr:0.00010 Loss: 6.2825 (6.5610) iLoss: 5.9738 (5.9859) TLoss: 0.3087 (0.5751) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [0][650/695] Time: 0.413 (0.443) lr:0.00010 Loss: 6.2974 (6.5401) iLoss: 5.9891 (5.9854) TLoss: 0.3083 (0.5547) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
==> Preparing Data Loader...
1
[ 9524  9601  9577 ... 19324 19325 19321]
[4107 4110 4125 ... 8929 8930 8929]
Epoch: [1][0/695] Time: 0.966 (0.966) lr:0.00010 Loss: 6.2913 (6.2913) iLoss: 5.9849 (5.9849) TLoss: 0.3064 (0.3064) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.00
Epoch: [1][50/695] Time: 0.403 (0.431) lr:0.00010 Loss: 6.2684 (6.2837) iLoss: 5.9603 (5.9758) TLoss: 0.3080 (0.3079) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.14
Epoch: [1][100/695] Time: 0.409 (0.422) lr:0.00010 Loss: 6.2553 (6.2843) iLoss: 5.9493 (5.9766) TLoss: 0.3060 (0.3077) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Epoch: [1][150/695] Time: 0.396 (0.419) lr:0.00010 Loss: 6.2799 (6.2846) iLoss: 5.9743 (5.9771) TLoss: 0.3056 (0.3075) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.30
Epoch: [1][200/695] Time: 0.425 (0.418) lr:0.00010 Loss: 6.2917 (6.2846) iLoss: 5.9853 (5.9773) TLoss: 0.3064 (0.3073) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.30
Epoch: [1][250/695] Time: 0.462 (0.418) lr:0.00010 Loss: 6.2947 (6.2847) iLoss: 5.9901 (5.9777) TLoss: 0.3046 (0.3070) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Epoch: [1][300/695] Time: 0.462 (0.418) lr:0.00010 Loss: 6.2898 (6.2847) iLoss: 5.9841 (5.9779) TLoss: 0.3056 (0.3068) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Epoch: [1][350/695] Time: 0.457 (0.418) lr:0.00010 Loss: 6.2703 (6.2844) iLoss: 5.9648 (5.9778) TLoss: 0.3055 (0.3066) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.27
Epoch: [1][400/695] Time: 0.463 (0.418) lr:0.00010 Loss: 6.3031 (6.2841) iLoss: 5.9924 (5.9776) TLoss: 0.3107 (0.3065) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.27
Epoch: [1][450/695] Time: 0.451 (0.417) lr:0.00010 Loss: 6.2703 (6.2841) iLoss: 5.9654 (5.9777) TLoss: 0.3049 (0.3064) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [1][500/695] Time: 0.455 (0.417) lr:0.00010 Loss: 6.2704 (6.2841) iLoss: 5.9657 (5.9778) TLoss: 0.3048 (0.3063) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.25
Epoch: [1][550/695] Time: 0.465 (0.418) lr:0.00010 Loss: 6.2775 (6.2839) iLoss: 5.9726 (5.9777) TLoss: 0.3050 (0.3062) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [1][600/695] Time: 0.409 (0.418) lr:0.00010 Loss: 6.2847 (6.2837) iLoss: 5.9801 (5.9776) TLoss: 0.3046 (0.3061) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [1][650/695] Time: 0.412 (0.418) lr:0.00010 Loss: 6.2942 (6.2836) iLoss: 5.9902 (5.9777) TLoss: 0.3040 (0.3060) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Test Epoch: 1
Extracting Gallery Feature...
Extracting Time:	 2.967
Extracting Query Feature...
Extracting Time:	 10.354
Evaluation Time:	 5.948
[0.01367342 0.02576913 0.04102025 0.05469366 0.06968183 0.08388115
 0.09623981 0.10780963 0.12227189 0.1359453  0.14961872 0.16118853
 0.1735472  0.185117   0.19353142 0.20536418 0.2137786  0.22377071
 0.23534052 0.24743624]
POOL:   Rank-1: 1.37% | Rank-5: 6.97% | Rank-10: 13.59%| Rank-20: 24.74%| mAP: 3.42%| mINP: 1.71%
FC:   Rank-1: 1.42% | Rank-5: 6.78% | Rank-10: 13.73%| Rank-20: 24.77%| mAP: 3.41%| mINP: 1.71%
Best Epoch [1]
==> Preparing Data Loader...
2
[1076 1089 1127 ... 5110 5068 5044]
[ 432  449  449 ... 2203 2202 2192]
Epoch: [2][0/695] Time: 1.069 (1.069) lr:0.00010 Loss: 6.2828 (6.2828) iLoss: 5.9779 (5.9779) TLoss: 0.3050 (0.3050) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 1.56
Epoch: [2][50/695] Time: 0.411 (0.434) lr:0.00010 Loss: 6.2779 (6.2821) iLoss: 5.9743 (5.9775) TLoss: 0.3036 (0.3046) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.31
Epoch: [2][100/695] Time: 0.403 (0.427) lr:0.00010 Loss: 6.2796 (6.2816) iLoss: 5.9754 (5.9772) TLoss: 0.3042 (0.3045) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.25
Epoch: [2][150/695] Time: 0.412 (0.425) lr:0.00010 Loss: 6.2786 (6.2814) iLoss: 5.9747 (5.9769) TLoss: 0.3040 (0.3045) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [2][200/695] Time: 0.413 (0.422) lr:0.00010 Loss: 6.2807 (6.2813) iLoss: 5.9766 (5.9769) TLoss: 0.3041 (0.3044) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Epoch: [2][250/695] Time: 0.401 (0.422) lr:0.00010 Loss: 6.2813 (6.2812) iLoss: 5.9780 (5.9768) TLoss: 0.3033 (0.3043) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Epoch: [2][300/695] Time: 0.411 (0.421) lr:0.00010 Loss: 6.2789 (6.2814) iLoss: 5.9755 (5.9772) TLoss: 0.3034 (0.3042) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [2][350/695] Time: 0.409 (0.421) lr:0.00010 Loss: 6.2864 (6.2814) iLoss: 5.9830 (5.9773) TLoss: 0.3034 (0.3041) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [2][400/695] Time: 0.401 (0.420) lr:0.00010 Loss: 6.2707 (6.2812) iLoss: 5.9671 (5.9772) TLoss: 0.3036 (0.3040) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.25
Epoch: [2][450/695] Time: 0.403 (0.420) lr:0.00010 Loss: 6.2848 (6.2811) iLoss: 5.9816 (5.9772) TLoss: 0.3031 (0.3040) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.23
Epoch: [2][500/695] Time: 0.412 (0.420) lr:0.00010 Loss: 6.2792 (6.2811) iLoss: 5.9759 (5.9772) TLoss: 0.3033 (0.3039) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.22
Epoch: [2][550/695] Time: 0.411 (0.420) lr:0.00010 Loss: 6.2821 (6.2810) iLoss: 5.9787 (5.9771) TLoss: 0.3034 (0.3039) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.22
Epoch: [2][600/695] Time: 0.408 (0.420) lr:0.00010 Loss: 6.2688 (6.2809) iLoss: 5.9654 (5.9770) TLoss: 0.3034 (0.3039) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.22
Epoch: [2][650/695] Time: 0.405 (0.420) lr:0.00010 Loss: 6.2817 (6.2808) iLoss: 5.9777 (5.9769) TLoss: 0.3040 (0.3039) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.22
==> Preparing Data Loader...
3
[18948 18933 18940 ... 17397 17443 17421]
[8563 8548 8563 ... 7494 7504 7498]
Epoch: [3][0/695] Time: 1.039 (1.039) lr:0.00010 Loss: 6.2821 (6.2821) iLoss: 5.9769 (5.9769) TLoss: 0.3052 (0.3052) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 1.56
Epoch: [3][50/695] Time: 0.476 (0.433) lr:0.00010 Loss: 6.2777 (6.2797) iLoss: 5.9734 (5.9749) TLoss: 0.3044 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.34
Epoch: [3][100/695] Time: 0.446 (0.424) lr:0.00010 Loss: 6.3007 (6.2792) iLoss: 5.9960 (5.9741) TLoss: 0.3048 (0.3051) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [3][150/695] Time: 0.453 (0.417) lr:0.00010 Loss: 6.2725 (6.2797) iLoss: 5.9680 (5.9747) TLoss: 0.3045 (0.3050) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.21
Epoch: [3][200/695] Time: 0.462 (0.418) lr:0.00010 Loss: 6.2893 (6.2802) iLoss: 5.9831 (5.9752) TLoss: 0.3062 (0.3050) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.23
Epoch: [3][250/695] Time: 0.470 (0.418) lr:0.00010 Loss: 6.2684 (6.2802) iLoss: 5.9637 (5.9752) TLoss: 0.3048 (0.3050) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [3][300/695] Time: 0.463 (0.418) lr:0.00010 Loss: 6.2828 (6.2803) iLoss: 5.9779 (5.9754) TLoss: 0.3050 (0.3049) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.24
Epoch: [3][350/695] Time: 0.461 (0.418) lr:0.00010 Loss: 6.2690 (6.2805) iLoss: 5.9659 (5.9757) TLoss: 0.3031 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [3][400/695] Time: 0.416 (0.418) lr:0.00010 Loss: 6.2965 (6.2803) iLoss: 5.9905 (5.9756) TLoss: 0.3061 (0.3047) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.27
Epoch: [3][450/695] Time: 0.413 (0.418) lr:0.00010 Loss: 6.2850 (6.2803) iLoss: 5.9803 (5.9755) TLoss: 0.3048 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.27
Epoch: [3][500/695] Time: 0.408 (0.418) lr:0.00010 Loss: 6.2742 (6.2804) iLoss: 5.9697 (5.9756) TLoss: 0.3045 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.26
Epoch: [3][550/695] Time: 0.411 (0.417) lr:0.00010 Loss: 6.2741 (6.2802) iLoss: 5.9687 (5.9755) TLoss: 0.3054 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.27
Epoch: [3][600/695] Time: 0.414 (0.417) lr:0.00010 Loss: 6.2919 (6.2802) iLoss: 5.9868 (5.9754) TLoss: 0.3051 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Epoch: [3][650/695] Time: 0.408 (0.417) lr:0.00010 Loss: 6.2695 (6.2801) iLoss: 5.9643 (5.9754) TLoss: 0.3052 (0.3048) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.28
Test Epoch: 3
Extracting Gallery Feature...
Extracting Time:	 1.427
Extracting Query Feature...
Extracting Time:	 8.982
Evaluation Time:	 6.095
[0.01709177 0.03576124 0.05127531 0.06337103 0.07809624 0.09413621
 0.10728373 0.12122009 0.1333158  0.14330791 0.15855904 0.16855115
 0.18222456 0.19274257 0.20352353 0.21930055 0.23428872 0.24480674
 0.25953194 0.27110177]
POOL:   Rank-1: 1.71% | Rank-5: 7.81% | Rank-10: 14.33%| Rank-20: 27.11%| mAP: 3.73%| mINP: 1.87%
FC:   Rank-1: 1.84% | Rank-5: 8.28% | Rank-10: 15.09%| Rank-20: 27.48%| mAP: 3.78%| mINP: 1.85%
Best Epoch [3]
==> Preparing Data Loader...
4
[6088 6095 6073 ... 1956 1884 1946]
[2636 2611 2614 ...  774  774  791]
Epoch: [4][0/695] Time: 0.992 (0.992) lr:0.00010 Loss: 6.2712 (6.2712) iLoss: 5.9661 (5.9661) TLoss: 0.3051 (0.3051) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 2.34
Epoch: [4][50/695] Time: 0.400 (0.428) lr:0.00010 Loss: 6.3220 (6.2739) iLoss: 6.0094 (5.9661) TLoss: 0.3127 (0.3078) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.49
Epoch: [4][100/695] Time: 0.414 (0.424) lr:0.00010 Loss: 6.2946 (6.2779) iLoss: 5.9891 (5.9704) TLoss: 0.3055 (0.3075) p2eLoss: 0.0000 (0.0000) p2pLoss: 0.0000 (0.0000) Accu: 0.39
